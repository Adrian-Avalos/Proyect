<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="icono.ico">
  <link rel="icon" type="image/x-icon" href="icono.ico">
  <title>Generador datos.js con categor√≠as fijas</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light p-4">

<div class="container">

<div class="container mb-5">
  <div class="d-flex gap-3 justify-content-center mt-4">
    <a href="Calculadora-Nutricional-base.html" class="btn btn-outline-secondary">üìÅ Con base de datos</a>
  </div>
</div>


  <div class="d-flex gap-2 mb-4">
    <a href="menu.html" class="btn btn-secondary flex-fill">üîô Volver al inicio</a>
  </div>

  <h2 class="mb-4 text-center">üçΩÔ∏è Generador completo de datos.js</h2>

  <!-- Formulario -->
  <form id="formulario" class="row g-3">
    <div class="col-md-6">
      <label>Categor√≠a</label>
      <select id="categoria" class="form-select" required>
        <option value="">-- Seleccion√° una categor√≠a --</option>
        <option value="L√ÅCTEOS">L√ÅCTEOS</option>
        <option value="HUEVOS">HUEVOS</option>
        <option value="CARNE - AVES">CARNE - AVES</option>
        <option value="CARNE - VACUNA">CARNE - VACUNA</option>
        <option value="CARNE - PESCADO">CARNE - PESCADO</option>
        <option value="VEGETALES A">VEGETALES A</option>
        <option value="VEGETALES B">VEGETALES B</option>
        <option value="VEGETALES C">VEGETALES C</option>
        <option value="FRUTAS A">FRUTAS A</option>
        <option value="FRUTAS B">FRUTAS B</option>
        <option value="FRUTAS C">FRUTAS C</option>
        <option value="FRUTOS SECOS">FRUTOS SECOS</option>
        <option value="CEREALES">CEREALES</option>
        <option value="PANIFICADOS">PANIFICADOS</option>
        <option value="DULCES">DULCES</option>
        <option value="GRASAS">GRASAS</option>
        <option value="OTROS">OTROS</option>
      </select>
    </div>

    <div class="col-md-6">
      <label>Nombre del alimento</label>
      <input type="text" id="nombre" class="form-control" required />
    </div>

    <div class="col-md-4"><label>Medida casera</label><input type="text" id="medida_casera" class="form-control" required /></div>
    <div class="col-md-4"><label>Medida</label><input type="number" step="0.1" id="medida" class="form-control" required /></div>
    <div class="col-md-4">
      <label>Unidad</label>
      <select id="unidad" class="form-select" required>
        <option value="">-- Seleccion√° unidad --</option>
        <option value="mg">mg</option>
        <option value="ml">ml</option>
        <option value="kilos">kilos</option>
        <option value="litros">litros</option>
      </select>
    </div>

    <!-- Nutrientes -->
    <div class="col-md-3"><label>Calor√≠as</label><input type="number" step="0.1" id="calorias" class="form-control" /></div>
    <div class="col-md-3"><label>HC (g)</label><input type="number" step="0.1" id="hc" class="form-control" /></div>
    <div class="col-md-3"><label>Prote√≠nas</label><input type="number" step="0.1" id="proteinas" class="form-control" /></div>
    <div class="col-md-3"><label>Grasas</label><input type="number" step="0.1" id="grasas" class="form-control" /></div>

    <div class="col-md-3"><label>Sodio (Na mg)</label><input type="number" step="0.1" id="na" class="form-control" /></div>
    <div class="col-md-3"><label>Potasio (K mg)</label><input type="number" step="0.1" id="k" class="form-control" /></div>
    <div class="col-md-3"><label>F√≥sforo (P mg)</label><input type="number" step="0.1" id="p" class="form-control" /></div>
    <div class="col-md-3"><label>Calcio (Ca mg)</label><input type="number" step="0.1" id="ca" class="form-control" /></div>

    <div class="col-md-3"><label>Hierro (Fe mg)</label><input type="number" step="0.1" id="fe" class="form-control" /></div>
    <div class="col-md-3"><label>Colesterol (mg)</label><input type="number" step="0.1" id="colest" class="form-control" /></div>
    <div class="col-md-3"><label>Purinas (mg)</label><input type="number" step="0.1" id="purinas" class="form-control" /></div>
    <div class="col-md-3"><label>Fibra (g)</label><input type="number" step="0.1" id="fibra" class="form-control" /></div>

    <div class="col-md-3"><label>Agua (g)</label><input type="number" step="0.1" id="agua" class="form-control" /></div>
    <div class="col-md-3"><label>√Åcido f√≥lico (¬µg)</label><input type="number" step="0.1" id="afolic" class="form-control" /></div>

    <div class="col-12">
      <button type="submit" class="btn btn-success w-100">‚ûï Agregar alimento</button>
    </div>
  </form>

  <hr class="my-4">

  <!-- Nombre de archivo -->
  <div class="mb-3">
    <label for="nombreArchivo" class="form-label fw-bold">üìÅ Nombre del archivo a guardar:</label>
    <input type="text" id="nombreArchivo" class="form-control" placeholder="Ej: datos-nuevos.js" />
  </div>

  <!-- Botones -->
  <div class="d-flex gap-2 mb-4">
    <button class="btn btn-primary flex-fill" onclick="descargarDatos()">‚¨áÔ∏è Descargar archivo</button>
    <a href="menu.html" class="btn btn-secondary flex-fill">üîô Volver al inicio</a>
  </div>

  <h5 class="mb-2">Vista previa del archivo generado:</h5>
  <textarea id="preview" class="form-control" rows="20" readonly></textarea>
</div>

<script>
  const baseDatos = {};

  document.getElementById('formulario').addEventListener('submit', function (e) {
    e.preventDefault();
    const get = id => {
      const val = document.getElementById(id).value.trim();
      return val === "" ? null : isNaN(val) ? val : parseFloat(val);
    };

    const categoria = get('categoria');
    const nombre = get('nombre');
    if (!categoria || !nombre) return alert("Complet√° categor√≠a y nombre");

    const alimento = {
      medida_casera: get('medida_casera'),
      medida: get('medida'),
      unidad: get('unidad'),
      calorias: get('calorias'),
      hc: get('hc'),
      proteinas: get('proteinas'),
      grasas: get('grasas'),
      na: get('na'),
      k: get('k'),
      p: get('p'),
      ca: get('ca'),
      fe: get('fe'),
      colest: get('colest'),
      purinas: get('purinas'),
      fibra: get('fibra'),
      agua: get('agua'),
      afolic: get('afolic')
    };

    if (!baseDatos[categoria]) baseDatos[categoria] = {};
    baseDatos[categoria][nombre] = alimento;

    actualizarPreview();
    document.getElementById('formulario').reset();
  });

  function actualizarPreview() {
    const contenido = "const baseDatos = " + JSON.stringify(baseDatos, null, 2) + ";";
    document.getElementById('preview').value = contenido;
  }

  function descargarDatos() {
    const contenido = "const baseDatos = " + JSON.stringify(baseDatos, null, 2) + ";";
    const nombre = document.getElementById('nombreArchivo').value.trim() || "datos.js";
    const blob = new Blob([contenido], { type: "application/javascript" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = nombre.endsWith(".js") ? nombre : nombre + ".js";
    a.click();
    URL.revokeObjectURL(url);
  }
</script>

</body>
</html>
